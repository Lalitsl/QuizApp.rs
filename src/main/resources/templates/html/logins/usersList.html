<!DOCTYPE html>
<html>

<head>
	<title>users list</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
		crossorigin="anonymous"></script>

	<!-- font awesome link for icons -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
		integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
		crossorigin="anonymous" referrerpolicy="no-referrer" />

	<style>
		* {
			font-family: "Gill Sans", sans-serif;
		}

        
		.navbar a:hover {
			color: #b44593;
		}

		nav {
			height: 60px;
		}

		.gradient-custom-2 {
			background: linear-gradient(to right, #ee7724, #d8363a, #dd3675, #b44593);
		}

		.nav-item a:hover {
			background: linear-gradient(to right, #ee7724, #d8363a, #dd3675, #b44593);
			border-radius: 10px;

		}
		
		button{
			border:none
		}
	</style>
</head>

<body>
	<!--  navbar code is start here  -->
	<section>
		<nav class="navbar navbar-expand-lg fixed-top navbar-dark" style="background-color:#212529; padding: 0;">
			<div class="container-fluid" style="height: 60px;">
				<img src="https://png.pngtree.com/png-vector/20220827/ourmid/pngtree-quiz-time-png-image_6125411.png"
					style="width: 100px; height: auto;">
				<a class="navbar-brand fs-3" href="#">QuizX</a>
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse"
					data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
					aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="collapse navbar-collapse d-flex justify-content-end" id="navbarSupportedContent">
					<ul class="navbar-nav">
						<li class="nav-item">
							<a class="nav-link active" aria-current="page" href="/">Home</a>
						</li>
						<li class="nav-item">
							<a class="nav-link active" aria-current="page" href="#">About</a>
						</li>
						<li class="nav-item">
							<a class="nav-link active" aria-current="page" href="#">Contact</a>
						</li>
					</ul>
					<a class="btn gradient-custom-2 mx-3 log01 text-light" href="/user/page/login">logout</a>
				</div>
			</div>
		</nav>
	</section>
	<!--  navbar code is end here  -->

	<!--	List Quiz page code start here -->

	<section class="h-100 gradient-form">
		<div class="container py-2 h-100">
			<h4 class="py-3 text-center fw-bold">Question list is here </h4>

			<div class="btn-group float-end my-3" role="group" aria-label="Basic outlined example">
				<a href="" class="btn btn-outline-primary">Refresh</a>
			</div>
			<div class="justify-content-center align-items-center">

				<table class="table table-striped table-bordered shadow-lg">
					<thead>
						<tr>
							<th scope="col">Reg.no</th>
							<th scope="col">Fist Name</th>
							<th scope="col">Last Name</th>
							<th scope="col">User Type </th>
							<th scope="col">Role</th>
							<th scope="col">Email Address </th>
							<th scope="col">Phone No. </th>
							<th scope="col">Address</th>
							<th scope="col">Created At</th>
							<th scope="col">Operations</th>
						</tr>
					</thead>
					<tbody id="userTableBody">

					</tbody>
				</table>

				<nav class="float-end my-3" aria-label="Page navigation example">
					<ul class="pagination">
						<li class="page-item"><a class="page-link" href="#"><i class="fa-solid fa-chevron-left"></i></a>
						</li>
						<li class="page-item"><a class="page-link" href="#">1</a></li>
						<li class="page-item"><a class="page-link" href="#">2</a></li>
						<li class="page-item"><a class="page-link" href="#">3</a></li>
						<li class="page-item"><a class="page-link" href="#"><i
									class="fa-solid fa-chevron-right"></i></a></li>
					</ul>
				</nav>

			</div>
		</div>
	</section>
	<!--	List Quiz page code end here -->

	<script>
		const deleteButton = document.getElementById("deleteButton");

		function getUsersList() {

			const apiUrl = "http://localhost:9090/user/usersList";

			fetch(apiUrl, {
				method: 'GET',
			})
				.then(response => response.json())
				.then(data => {

					const userTableBody = document.getElementById('userTableBody');
					userTableBody.innerHTML = '';  // Clear existing rows

					if (data && data.payload && Array.isArray(data.payload)) {
						const payload = data.payload;

						for (let i = 0; i < payload.length; i++) {
							const user = payload[i];
							const row = document.createElement('tr');
							row.innerHTML = `
                                    <th scope="row">${user.userId}</th>
                                    <td>${user.firstName}</td>
                                    <td>${user.lastName}</td>
                                    <td>${user.userType}</td>
                                    <td>${user.role || 'N/A'}</td>
                                    <td>${user.emailAddress}</td>
                                    <td>${user.phone || 'N/A'}</td>
                                    <td>${user.address || 'N/A'}</td>
                                    <td>${user.created_At}</td>
                                  <td>
								     <a href="http://localhost:9090/user/page/updateUser/${user.userId}"><i class="fa-solid fa-pen-to-square mx-2"></i></a>
								     <button onclick="deleteUser(${user.userId})"> <i class="fa-solid fa-trash mx-2 text-danger"></i></button>
							      </td>
                                `;
							userTableBody.appendChild(row);
						}
					} else {
						alert("No data found or data format is incorrect");
					}
				})
				.catch(error => {
					console.error('Error:', error);
					alert("Error fetching data");
				});
		} window.addEventListener('load', getUsersList())



		function deleteUser(userId) {
			console.log(userId);
			const apiUrl = `http://localhost:9090/user/deleteUser/${userId}`;
			fetch(apiUrl, {
				method: 'DELETE',
			})
				.then(response => response.json())
				.then(data => {
					console.log(data);
					if (data.statusCode === 200) {
						alert("user is deleted successfully ")
						getUsersList();

					}
					else {
						alert("No data found for user");
						getUsersList();
					}
				})
				.catch(error => {
					console.error('Error:', error);
					alert("Error fetching data");
				});
		}
	</script>

</body>

</html>